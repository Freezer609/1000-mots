<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1000 mots</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0D0B1A">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
</head>
<body>
    <div class="bg-mesh">
        <div class="mesh-blob mesh-blob-1"></div>
        <div class="mesh-blob mesh-blob-2"></div>
        <div class="mesh-blob mesh-blob-3"></div>
        <div class="mesh-blob mesh-blob-4"></div>
        <div class="mesh-grid"></div>
    </div>

    <div class="container">
        <header>
            <div class="header-left">
                <h1 id="mainTitle">1000 mots</h1>
            </div>
            <div class="header-right">
                <nav class="mode-selector">
                    <button id="flashcardModeBtn" class="active">Flashcards</button>
                    <button id="reverseModeBtn">Reverse</button>
                    <button id="quizModeBtn">Quiz</button>
                    <button id="hangmanModeBtn">Hangman</button>
                    <button id="scrambleModeBtn">Scramble</button>
                    <button id="dictationModeBtn">Dictation</button>
                    <button id="matchModeBtn">Match</button>
                </nav>
                <button id="statsBtn" class="icon-btn" title="Statistiques"><i class="fas fa-chart-line"></i></button>
                <button id="settingsBtn" class="icon-btn" title="Paramètres"><i class="fas fa-cog"></i></button>
            </div>
        </header>

        <div class="selectors-container">
            <div class="custom-select-wrapper" id="chapterSelectWrapper">
                <div class="custom-select-trigger">Choisir un chapitre</div>
                <div class="custom-options" id="customChapterOptions">
                    <select id="chapterSelect" class="styled-select hidden-select">
                        <option value="" disabled selected>Choisir un chapitre</option>
                    </select>
                </div>
            </div>
            <div class="custom-select-wrapper" id="subcategorySelectWrapper">
                <div class="custom-select-trigger">Choisir une liste</div>
                <div class="custom-options" id="customSubcategoryOptions">
                    <select id="subcategorySelect" class="styled-select hidden-select" disabled>
                        <option value="" disabled selected>Choisir une liste</option>
                    </select>
                </div>
            </div>
            <div class="search-filter-wrapper">
                <input id="searchInput" type="search" placeholder="Rechercher un mot, définition..." aria-label="Recherche de vocabulaire">
                <div class="filter-controls">
                    <label><input type="checkbox" id="filterMastered"> Montrés maîtrisés</label>
                    <label><input type="checkbox" id="filterUnmastered" checked> Montrés non maîtrisés</label>
                </div>
            </div>
            <div class="adaptive-session-controls">
                <button id="adaptiveSessionBtn" class="icon-btn">Démarrer session adaptative</button>
                <button id="adaptiveEndBtn" class="icon-btn" style="display:none;">Terminer session</button>
                <label for="adaptiveSortSelect" style="margin-left:8px; color:rgba(255,255,255,0.8); font-size:0.9rem;">Trier:</label>
                <div class="custom-select-wrapper" id="adaptiveSortWrapper" style="max-width:180px;">
                    <div class="custom-select-trigger">Par échéance</div>
                    <div class="custom-options">
                        <select id="adaptiveSortSelect" class="hidden-select">
                            <option value="due" selected>Par échéance</option>
                            <option value="ef">Par difficulté (EF)</option>
                            <option value="random">Aléatoire</option>
                        </select>
                    </div>
                </div>
                <span id="adaptiveDueCount" aria-live="polite" style="margin-left:8px;color:rgba(255,255,255,0.8)"></span>
            </div>
        </div>
        <div id="alertMessage" class="alert-message" style="display:none;" role="status" aria-live="polite"></div>
        <div id="liveStatus" aria-live="polite" aria-atomic="true" style="position:fixed;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;"></div>

        <main id="game-zone">
            <div id="flashcardGameContainer" class="game-container active-mode">
                <button class="nav-arrow prev-arrow" id="prevCardBtn" aria-label="Carte précédente" title="Carte précédente"><i class="fas fa-chevron-left" aria-hidden="true"></i></button>

                <div class="card-container">
                    <div id="flashcard" class="card">
                                <div id="front" class="card-face card-front" role="button" tabindex="0" aria-label="Carte: mot principal. Appuyez pour retourner la carte">
                                    <span class="word-type" aria-hidden="true">adjective</span>
                                    <h2 class="word">Epehernal</h2>
                                    <div class="card-front-controls">
                                        <button id="playWordBtn" class="icon-btn" title="Écouter" aria-label="Écouter le mot"><i class="fas fa-play" aria-hidden="true"></i></button>
                                        <i class="fas fa-brain" aria-hidden="true"></i>
                                    </div>
                                </div>
                        <div id="back" class="card-face card-back">
                            <div class="card-content">
                                <p>Fugace, de courte durée</p>
                            </div>
                            <div class="feedback-buttons">
                                <button id="didntKnowBtn">Je ne l'avais pas</button>
                                <button id="masteredBtn">Maîtriser</button>
                                <button id="knewItBtn">Je l'avais</button>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="nav-arrow next-arrow" id="nextCardBtn" aria-label="Carte suivante" title="Carte suivante"><i class="fas fa-chevron-right" aria-hidden="true"></i></button>

                <div class="bottom-ui">
                    <div class="progress-container">
                        <span id="cardCounter">7/10</span>
                        <div class="progress-bar-background">
                            <div id="progressBar" class="progress-bar-foreground"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other game containers remain the same -->
            <div id="quizGameContainer" class="game-container">
                <div id="quizScore" class="quiz-score">Score: 0 / 0</div>
                <div id="quizQuestion" class="quiz-question"></div>
                <div id="quizOptions" class="quiz-options"></div>
            </div>

            <div id="hangmanGameContainer" class="game-container">
                <svg class="hangman-drawing" viewBox="0 0 200 200">
                    <line x1="10" y1="190" x2="150" y2="190" class="hangman-svg-part" />
                    <line x1="40" y1="190" x2="40" y2="20" class="hangman-svg-part" />
                    <line x1="40" y1="20" x2="120" y2="20" class="hangman-svg-part" />
                    <line x1="120" y1="20" x2="120" y2="40" class="hangman-svg-part" />
                    <circle id="head" cx="120" cy="55" r="15" class="hangman-svg-part" />
                    <line id="body" x1="120" y1="70" x2="120" y2="120" class="hangman-svg-part" />
                    <line id="arm1" x1="120" y1="80" x2="100" y2="100" class="hangman-svg-part" />
                    <line id="arm2" x1="120" y1="80" x2="140" y2="100" class="hangman-svg-part" />
                    <line id="leg1" x1="120" y1="120" x2="100" y2="150" class="hangman-svg-part" />
                    <line id="leg2" x1="120" y1="120" x2="140" y2="150" class="hangman-svg-part" />
                </svg>
                <div id="hangmanWord" class="hangman-word"></div>
                <div id="hangmanLetters" class="hangman-letters"></div>
            </div>

            <div id="scrambleGameContainer" class="game-container">
                <div id="scrambleWord" class="quiz-question"></div>
                <div id="scrambleClue" class="scramble-clue"></div>
                <input type="text" id="scrambleInput" placeholder="Écris le mot ici..." autocomplete="off">
                <button id="scrambleCheckBtn">Vérifier</button>
                <div id="scrambleFeedback" class="scramble-feedback"></div>
                <button id="scrambleNextBtn" style="display:none;">Mot Suivant &rarr;</button>
            </div>

            <div id="dictationGameContainer" class="game-container">
                <div id="dictationClue" class="dictation-clue"></div>
                <input type="text" id="dictationInput" placeholder="Écris le mot exact ici..." autocomplete="off">
                <button id="dictationCheckBtn">Vérifier</button>
                <div id="dictationFeedback" class="dictation-feedback"></div>
                <button id="dictationNextBtn" style="display:none;">Mot Suivant &rarr;</button>
            </div>

            <div id="matchGameContainer" class="game-container">
                <div id="matchScore">Paires trouvées : 0 / 6</div>
                <div id="matchGrid">
                    <div id="wordsColumn" class="match-column"></div>
                    <div id="definitionsColumn" class="match-column"></div>
                </div>
                <button id="matchNextBtn" style="display:none; margin-top: 30px;">Prochain Match &rarr;</button>
            </div>
        </main>

        <div class="details-section">
            <details id="adaptiveDetails">
                <summary>Session adaptative (mots dus)</summary>
                <div class="list-content">
                    <ul id="adaptiveQueueList" class="vocabulary-list"></ul>
                    <div style="margin-top:8px; display:flex; gap:8px;">
                        <button id="adaptiveSkipBtn" class="icon-btn">Ignorer courant</button>
                        <button id="adaptiveRebuildBtn" class="icon-btn">Recalculer file</button>
                        <div class="custom-select-wrapper" id="adaptiveExportFormatWrapper" style="display:inline-block;">
                            <div class="custom-select-trigger">Format</div>
                            <div class="custom-options">
                                <select id="adaptiveExportFormat" style="background:transparent; color:inherit; border:0; padding:6px;">
                                    <option value="csv">CSV (Excel)</option>
                                    <option value="tsv">TSV (Anki)</option>
                                </select>
                            </div>
                        </div>
                        <button id="adaptiveExportBtn" class="icon-btn">Exporter session</button>
                    </div>
                </div>
            </details>
            <details id="masteredDetails">
                <summary>Mots Maîtrisés</summary>
                <div class="list-content">
                    <ul id="masteredVocabularyList" class="vocabulary-list"></ul>
                    <button id="resetMasteredBtn" class="reset-btn">Réinitialiser</button>
                </div>
            </details>
            <details id="vocabDetails">
                <summary id="listTitle">Liste Complète</summary>
                <div class="list-content">
                    <div class="export-list-controls" style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
                        <div style="display:flex;gap:8px;align-items:center;">
                            <button id="exportListExcelBtn" class="icon-btn">Exporter imprimable (Excel)</button>
                            <button id="exportListCsvBtn" class="icon-btn icon-only" title="Exporter CSV" aria-label="Exporter CSV"><i class="fas fa-file-csv" aria-hidden="true"></i></button>
                        </div>
                        <div style="display:flex;gap:8px;align-items:center;margin-top:6px;">
                            <label style="font-size:0.9rem;color:rgba(255,255,255,0.8);">Options:</label>
                            <label><input type="checkbox" id="exportIncludeIndex" checked> Numéro</label>
                            <label><input type="checkbox" id="exportIncludeType" checked> Type</label>
                            <label for="exportOrientationSelect">Orientation:</label>
                            <div class="custom-select-wrapper" id="exportOrientationWrapper" style="display:inline-block;">
                                <div class="custom-select-trigger">Portrait</div>
                                <div class="custom-options">
                                    <select id="exportOrientationSelect" style="background:transparent; color:inherit; border:0; padding:4px;">
                                        <option value="portrait">Portrait (A4)</option>
                                        <option value="landscape">Paysage (A4)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <ul id="fullVocabularyList" class="vocabulary-list"></ul>
                </div>
            </details>

            <details>
                <summary>Comment Utiliser</summary>
                <div class="instructions-content">
                    <p>
                        - **Sélecteur de Chapitre** : Choisis la catégorie de vocabulaire à réviser en haut de la page.
                        - **Mode Cartes** : Clique sur la carte pour voir la définition, puis dis si tu l'avais ou non. Les mots non connus reviendront plus souvent.
                        - **Mode Quiz** : Lis le mot ou la définition et choisis la bonne réponse.
                        - **Mode Pendu** : Devine le mot en cliquant sur les lettres.
                        - **Mots Mélangés** : Un mot est mélangé, retrouve le mot original avec l'aide de sa définition.
                        - **Mode Dictée** : Écris le mot exact correspondant à la définition. (Attention aux accents et à l'orthographe exacte).
                        - **Mode Association** : Associe les mots à leur définition en cliquant sur une paire.
                    </p>
                </div>
            </details>
        </div>

    </div>

    <div id="statsModal" class="modal" style="display: none;">
        <div class="modal-content stats-content">
            <div class="stats-header" role="dialog" aria-modal="true" aria-labelledby="statsChapterTitle">
                <h3><i class="fas fa-terminal"></i> <span id="statsChapterTitle">Statistiques — Global</span></h3>
                <div class="stats-controls">
                    <input id="importStatsFile" type="file" accept="text/csv" style="display:none" aria-hidden="true">
                        <button id="importChapterStatsBtn" class="icon-btn icon-only" title="Importer" aria-label="Importer des statistiques"><i class="fas fa-file-import" aria-hidden="true"></i></button>
                        <button id="exportChapterStatsBtn" class="icon-btn icon-only" title="Exporter" aria-label="Exporter des statistiques"><i class="fas fa-file-export" aria-hidden="true"></i></button>
                        <button id="resetChapterStatsBtn" class="icon-btn" title="Réinitialiser" aria-label="Réinitialiser les statistiques"><i class="fas fa-redo" aria-hidden="true"></i></button>
                     <input id="importSRSFile" type="file" accept="application/json" style="display:none" aria-hidden="true">
                     <input id="importMasteredFile" type="file" accept="application/json" style="display:none" aria-hidden="true">
                         <button id="importSRSBtn" class="icon-btn icon-only" title="Importer SRS" aria-label="Importer SRS"><i class="fas fa-cloud-arrow-down" aria-hidden="true"></i></button>
                         <button id="exportSRSBtn" class="icon-btn icon-only" title="Exporter SRS" aria-label="Exporter SRS"><i class="fas fa-cloud-arrow-up" aria-hidden="true"></i></button>
                         <button id="importMasteredBtn" class="icon-btn icon-only" title="Importer maîtrisés" aria-label="Importer maîtrisés"><i class="fas fa-users" aria-hidden="true"></i></button>
                         <button id="exportMasteredBtn" class="icon-btn icon-only" title="Exporter maîtrisés" aria-label="Exporter maîtrisés"><i class="fas fa-users-cog" aria-hidden="true"></i></button>
                     <button class="close-modal" aria-label="Fermer">&times;</button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card main-stat">
                    <span class="stat-label">MAÎTRISE GLOBALE</span>
                    <span class="stat-value" id="statTotalMastered">0%</span>
                    <div class="stat-bar-bg"><div class="stat-bar-fg" id="statTotalBar"></div></div>
                </div>

                <div class="stat-card">
                    <span class="stat-label">TEMPS TOTAL</span>
                    <span class="stat-value" id="statTime">00:00:00</span>
                </div>
            </div>

            <div class="radar-container">
                <svg id="radarChart" viewBox="0 0 200 200"></svg>
            </div>

            <div class="detailed-stats">
                <div class="detail-row"><span>RETENTION SYNAPTIQUE (Mémoire)</span> <span id="lvlMemory" class="stat-lvl">Lvl 1</span></div>
                <div class="detail-row"><span>VÉLOCITÉ COGNITIVE (Vitesse)</span> <span id="lvlSpeed" class="stat-lvl">Lvl 1</span></div>
                <div class="detail-row"><span>PRÉCISION LEXICALE (Ortho)</span> <span id="lvlPrecision" class="stat-lvl">Lvl 1</span></div>
                <div class="detail-row"><span>RECONNAISSANCE PATTERNS (Logique)</span> <span id="lvlLogic" class="stat-lvl">Lvl 1</span></div>
            </div>
        </div>
    </div>
    <div id="globalSpinner" class="global-spinner" aria-hidden="true" role="status" aria-live="polite"></div>
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-content settings-content">
            <div class="stats-header">
                <h3><i class="fas fa-cog"></i> Paramètres</h3>
                <button class="close-modal" id="closeSettings">&times;</button>
            </div>
            <div class="settings-grid">
                <div class="setting-row" style="flex-direction:column;align-items:stretch;">
                    <div class="setting-left" style="margin-bottom:10px;">
                        <i class="fas fa-palette setting-icon"></i>
                        <div class="setting-info">
                            <div class="setting-label">Thème</div>
                            <div class="setting-desc">Choisis l'apparence du site. Clique sur l'étoile pour définir le thème par défaut.</div>
                        </div>
                    </div>
                    <div class="theme-picker" id="themePicker">
                        <div class="theme-card" data-theme="midnight-aura">
                            <span class="theme-check"><i class="fas fa-check"></i></span>
                            <div class="theme-preview" style="background:#0D0B1A;">
                                <div class="theme-preview-dot" style="background:#6A4BFF;"></div>
                                <div class="theme-preview-dot" style="background:#A84BFF;"></div>
                            </div>
                            <span class="theme-card-name">Midnight Aura</span>
                            <span class="theme-card-label">Violet profond</span>
                            <button class="theme-default-btn" data-theme="midnight-aura" title="Définir par défaut"><i class="fas fa-star"></i> Par défaut</button>
                        </div>
                        <div class="theme-card" data-theme="aurora-borealis">
                            <span class="theme-check"><i class="fas fa-check"></i></span>
                            <div class="theme-preview" style="background:#0A1628;">
                                <div class="theme-preview-dot" style="background:#00D4AA;"></div>
                                <div class="theme-preview-dot" style="background:#00B4D8;"></div>
                            </div>
                            <span class="theme-card-name">Aurora Borealis</span>
                            <span class="theme-card-label">Aurore boréale</span>
                            <button class="theme-default-btn" data-theme="aurora-borealis" title="Définir par défaut"><i class="fas fa-star"></i> Par défaut</button>
                        </div>
                        <div class="theme-card" data-theme="sunset-ember">
                            <span class="theme-check"><i class="fas fa-check"></i></span>
                            <div class="theme-preview" style="background:#1A0F0A;">
                                <div class="theme-preview-dot" style="background:#FF6B35;"></div>
                                <div class="theme-preview-dot" style="background:#E8446D;"></div>
                            </div>
                            <span class="theme-card-name">Sunset Ember</span>
                            <span class="theme-card-label">Coucher de soleil</span>
                            <button class="theme-default-btn" data-theme="sunset-ember" title="Définir par défaut"><i class="fas fa-star"></i> Par défaut</button>
                        </div>
                    </div>
                </div>
                <div class="setting-row">
                        <div class="setting-left"><i class="fas fa-bullseye setting-icon"></i>
                            <div class="setting-info"><div class="setting-label">Seuil maîtrise</div>
                            <div class="setting-desc">Nombre de fois consécutives pour considérer un mot maîtrisé</div></div>
                            <button class="info-btn" data-tooltip="Définit combien de fois tu dois cliquer 'Je l'avais' pour marquer un mot maîtrisé">?</button>
                        </div>
                    <div class="setting-right"><input id="masteryThreshold" type="number" min="1" max="20" value="5"></div>
                </div>
                <div class="setting-row">
                    <div class="setting-left"><i class="fas fa-sparkles setting-icon"></i>
                        <div class="setting-info"><div class="setting-label">Confetti</div>
                        <div class="setting-desc">Effet visuel quand un mot est maîtrisé</div></div>
                        <button class="info-btn" data-tooltip="Active ou désactive l'effet confetti lors de la maîtrise">?</button>
                    </div>
                    <div class="setting-right"><input id="confettiEnabled" type="checkbox" checked></div>
                </div>
                <div class="setting-row">
                    <div class="setting-left"><i class="fas fa-desktop setting-icon"></i>
                        <div class="setting-info"><div class="setting-label">Desktop seulement</div>
                        <div class="setting-desc">Limiter le confetti aux ordinateurs (désactive sur mobile)</div></div>
                        <button class="info-btn" data-tooltip="Désactive le confetti sur appareils mobiles tactiles">?</button>
                    </div>
                    <div class="setting-right"><input id="confettiDesktopOnly" type="checkbox"></div>
                </div>
                <div class="setting-row">
                    <div class="setting-left"><i class="fas fa-universal-access setting-icon"></i>
                        <div class="setting-info"><div class="setting-label">Ignorer "réduire les animations"</div>
                        <div class="setting-desc">Forcer le confetti même si le système demande de réduire les animations</div></div>
                        <button class="info-btn" data-tooltip="Cochez pour afficher le confetti même si l'option système 'réduire les animations' est active">?</button>
                    </div>
                    <div class="setting-right"><input id="confettiIgnoreReducedMotion" type="checkbox"></div>
                </div>
                <div class="setting-row">
                    <div class="setting-left"><i class="fas fa-eye setting-icon"></i>
                        <div class="setting-info"><div class="setting-label">Afficher compteur</div>
                        <div class="setting-desc">Montrer le compteur de répétitions sur la carte</div></div>
                        <button class="info-btn" data-tooltip="Affiche un petit badge sur la carte indiquant le nombre de répétitions consécutives">?</button>
                    </div>
                    <div class="setting-right"><input id="showConsecBadge" type="checkbox" checked></div>
                </div>
                <div class="settings-actions">
                    <button id="saveSettingsBtn" class="icon-btn">OK</button>
                    <button id="resetSettingsBtn" class="icon-btn" title="Reset">R</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="vocab_data.js"></script>
    <script src="app.js"></script>
</body>
</html>
